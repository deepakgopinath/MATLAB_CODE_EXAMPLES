clc;

L1 = 0.55;
L2 = 0.3;
L3 = 0.06;

W1 = 0.045;


epsw = 0.01;
epsv = 0.001;

Tsd = [1,0,0,0.4;
       0,1,0,0;
       0,0,1,0.4;
       0,0,0,1
        ];
    
M = [1,0,0,0;
     0,1,0,0;
     0,0,1,(L1+L2+L3);
     0,0,0,1
    ];

S1 = [0,0,1,0,0,0]';
S2 = [0,1,0,0,0,0]';
S3 = [0,0,1,0,0,0]';
S4 = [0,1,0,-L1, 0, W1]';
S5 = [0,0,1,0,0,0]';
S6 = [0,1,0, -(L1+L2), 0,0,]';
S7 = [0,0,1,0,0,0]';
S = [S1,S2,S3,S4,S5,S6,S7];

B1 = [0,0,1,0,0,0]';
B2 = [0,1,0,(L1+L2+L3), 0, 0]';
B3 = [0,0,1,0,0,0]';
B4 = [0,1,0,L2+L3, 0, W1]';
B5 = [0,0,1,0,0,0]';
B6 = [0,1,0,L3,0,0]';
B7 = [0,0,1,0,0,0]';
B = [B1,B2,B3,B4,B5,B6,B7];

% theta0 = [0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]';
theta0 = zeros(7,1);
JMatFixedWam = IKinFixed(S, M, Tsd, theta0, epsw, epsv)
JMatBodyWam = IKinBody(B, M, Tsd, theta0, epsw, epsv);